/mmfs1/gscratch/ark/tjung2/miniconda3/envs/ckl/lib/python3.8/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:396: LightningDeprecationWarning: Argument `period` in `ModelCheckpoint` is deprecated in v1.3 and will be removed in v1.5. Please use `every_n_val_epochs` instead.
  rank_zero_deprecation(
Namespace(accelerator='ddp', adam_epsilon=1e-08, check_validation_only=False, checkpoint_path='', dataset='templama', dataset_version='full', early_stop_callback=False, eval_batch_size=32, freeze_embeds=False, freeze_encoder=False, freeze_level=0, learning_rate=0.001, max_grad_norm=0.5, max_input_length=50, max_output_length=25, method='baseline', mode='pretrain', model_name_or_path='google/t5-small-ssm', n_gpu=1, n_test=-1, n_train=-1, n_val=-1, num_train_epochs=30, num_workers=4, opt_level='O1', output_dir='outputs/T5_small_templama(full)_lr.001_baseline_prefixed_batch32', output_log=None, prefix=True, resume_from_checkpoint=None, seed=42, split=0, split_num=1, tokenizer_name_or_path='google/t5-small-ssm', train_batch_size=32, use_deepspeed=False, use_lr_scheduling=True, val_check_interval=1.0, warmup_steps=0, weight_decay=0.0)
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/1
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 1 processes
----------------------------------------------------------------------------------------------------
Not freezing any parameters!
split is 0
Length of dataset retrieving is.. 35226
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Set SLURM handle signals.
  | Name  | Type                       | Params
-----------------------------------------------------
0 | model | T5ForConditionalGeneration | 77.0 M
-----------------------------------------------------
77.0 M    Trainable params
0         Non-trainable params
77.0 M    Total params
307.845   Total estimated model params size (MB)
Validation sanity check: 0it [00:00, ?it/s]split is 0
Length of dataset retrieving is.. 5037
split is 0
Length of dataset retrieving is.. 35226










































Epoch 0:  88%|████████▊ | 1101/1258 [01:26<00:12, 12.70it/s, loss=1.84, v_num=vckb, em_score=0.000, f1_score=0.0734]































































































Epoch 1:  88%|████████▊ | 1102/1258 [01:27<00:12, 12.67it/s, loss=1.5, v_num=vckb, em_score=0.053, f1_score=0.182]






























































































Epoch 2:  87%|████████▋ | 1100/1258 [01:24<00:12, 13.06it/s, loss=1.21, v_num=vckb, em_score=0.0584, f1_score=0.185]



























































































Epoch 3:  87%|████████▋ | 1100/1258 [01:24<00:12, 13.05it/s, loss=0.991, v_num=vckb, em_score=0.0546, f1_score=0.165]






























































































Epoch 4:  88%|████████▊ | 1102/1258 [01:26<00:12, 12.75it/s, loss=0.781, v_num=vckb, em_score=0.0596, f1_score=0.156]





























































































Epoch 5:  88%|████████▊ | 1102/1258 [01:25<00:12, 12.86it/s, loss=0.643, v_num=vckb, em_score=0.0538, f1_score=0.168]






























































































Epoch 6:  88%|████████▊ | 1102/1258 [01:25<00:12, 12.91it/s, loss=0.511, v_num=vckb, em_score=0.055, f1_score=0.160]




























































































Epoch 7:  87%|████████▋ | 1100/1258 [01:25<00:12, 12.90it/s, loss=0.453, v_num=vckb, em_score=0.0498, f1_score=0.160]






























































































Epoch 8:  88%|████████▊ | 1102/1258 [01:25<00:12, 12.91it/s, loss=0.393, v_num=vckb, em_score=0.0588, f1_score=0.162]





























































































Epoch 9:  87%|████████▋ | 1100/1258 [01:24<00:12, 13.02it/s, loss=0.343, v_num=vckb, em_score=0.059, f1_score=0.155]






























































































Epoch 10:  87%|████████▋ | 1100/1258 [01:25<00:12, 12.82it/s, loss=0.266, v_num=vckb, em_score=0.0439, f1_score=0.153]




























































































Epoch 11:  87%|████████▋ | 1100/1258 [01:21<00:11, 13.45it/s, loss=0.232, v_num=vckb, em_score=0.0528, f1_score=0.157]




























































































Epoch 12:  87%|████████▋ | 1100/1258 [01:21<00:11, 13.45it/s, loss=0.206, v_num=vckb, em_score=0.0482, f1_score=0.151]




























































































Epoch 13:  87%|████████▋ | 1100/1258 [01:22<00:11, 13.27it/s, loss=0.182, v_num=vckb, em_score=0.0526, f1_score=0.153]






























































































Epoch 14:  87%|████████▋ | 1100/1258 [01:24<00:12, 12.98it/s, loss=0.168, v_num=vckb, em_score=0.0526, f1_score=0.150]































































































Epoch 15:  88%|████████▊ | 1102/1258 [01:26<00:12, 12.81it/s, loss=0.143, v_num=vckb, em_score=0.0588, f1_score=0.152]






























































































Epoch 16:  87%|████████▋ | 1100/1258 [01:24<00:12, 13.01it/s, loss=0.129, v_num=vckb, em_score=0.0524, f1_score=0.157]
































































































Epoch 17:  87%|████████▋ | 1100/1258 [01:25<00:12, 12.84it/s, loss=0.121, v_num=vckb, em_score=0.0558, f1_score=0.160]

































































































Epoch 18:  88%|████████▊ | 1102/1258 [01:28<00:12, 12.48it/s, loss=0.0946, v_num=vckb, em_score=0.054, f1_score=0.153]
































































































Epoch 19:  87%|████████▋ | 1100/1258 [01:26<00:12, 12.71it/s, loss=0.088, v_num=vckb, em_score=0.054, f1_score=0.158]
































































































Epoch 20:  88%|████████▊ | 1102/1258 [01:25<00:12, 12.82it/s, loss=0.0637, v_num=vckb, em_score=0.055, f1_score=0.158]































































































Epoch 21:  88%|████████▊ | 1102/1258 [01:25<00:12, 12.89it/s, loss=0.0817, v_num=vckb, em_score=0.0522, f1_score=0.153]































































































Epoch 22:  88%|████████▊ | 1102/1258 [01:26<00:12, 12.70it/s, loss=0.0599, v_num=vckb, em_score=0.0572, f1_score=0.163]
































































































Epoch 23:  88%|████████▊ | 1102/1258 [01:27<00:12, 12.61it/s, loss=0.0534, v_num=vckb, em_score=0.0574, f1_score=0.160]
































































































Epoch 24:  87%|████████▋ | 1100/1258 [01:26<00:12, 12.70it/s, loss=0.0444, v_num=vckb, em_score=0.0572, f1_score=0.158]


































































































Epoch 25:  88%|████████▊ | 1102/1258 [01:29<00:12, 12.36it/s, loss=0.0379, v_num=vckb, em_score=0.0554, f1_score=0.159]

































































































Epoch 26:  87%|████████▋ | 1100/1258 [01:26<00:12, 12.76it/s, loss=0.0383, v_num=vckb, em_score=0.059, f1_score=0.162]


































































































Epoch 27:  87%|████████▋ | 1100/1258 [01:27<00:12, 12.54it/s, loss=0.0297, v_num=vckb, em_score=0.058, f1_score=0.158]



































































































Epoch 28:  88%|████████▊ | 1102/1258 [01:29<00:12, 12.33it/s, loss=0.0281, v_num=vckb, em_score=0.0586, f1_score=0.160]


































































































Epoch 29:  88%|████████▊ | 1102/1258 [01:29<00:12, 12.31it/s, loss=0.0253, v_num=vckb, em_score=0.059, f1_score=0.159]
























































Validating: 100%|██████████| 158/158 [01:49<00:00,  1.71it/s]