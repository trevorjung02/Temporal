#!/bin/bash
#SBATCH --job-name=data-proc
#SBATCH --partition=gpu-a40
#SBATCH --account=ark
#SBATCH --nodes=1
#SBATCH --cpus-per-task=8
#SBATCH --mem=32G
#SBATCH --gres=gpu:1
#SBATCH --time=04:59:00
#SBATCH --mail-type=ALL
#SBATCH --mail-user=tjung2@uw.edu

# I use source to initialize conda into the right environment.
cat $0
echo "--------------------"

source ~/.bashrc
conda activate ckl

python run.py --config configs/templama/training/t5_kadapters_2010_prefixed.json
 
--------------------
/mmfs1/gscratch/ark/tjung2/miniconda3/envs/ckl/lib/python3.8/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:360: UserWarning: Checkpoint directory outputs/T5_small_templama(2010)_lr.001_adapters_prefixed exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
/mmfs1/gscratch/ark/tjung2/miniconda3/envs/ckl/lib/python3.8/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:396: LightningDeprecationWarning: Argument `period` in `ModelCheckpoint` is deprecated in v1.3 and will be removed in v1.5. Please use `every_n_val_epochs` instead.
  rank_zero_deprecation(
Some weights of T5ForConditionalGeneration were not initialized from the model checkpoint at google/t5-small-ssm and are newly initialized: ['kadapter.adapter.1.layer.1.DenseReluDense.wi_1.weight', 'kadapter.adapter.1.layer.0.SelfAttention.o.weight', 'kadapter.adapter.0.layer.0.layer_norm.weight', 'kadapter.adapter.0.layer.0.SelfAttention.k.weight', 'kadapter.adapter.1.layer.0.SelfAttention.k.weight', 'kadapter.layer_norm.weight', 'kadapter.adapter.1.layer.1.layer_norm.weight', 'kadapter.adapter.1.layer.0.SelfAttention.q.weight', 'kadapter.adapter.0.layer.1.layer_norm.weight', 'kadapter.adapter.0.layer.1.DenseReluDense.wo.weight', 'kadapter.adapter.0.layer.1.DenseReluDense.wi_0.weight', 'kadapter.adapter.1.layer.1.DenseReluDense.wi_0.weight', 'kadapter.adapter.0.layer.0.SelfAttention.q.weight', 'kadapter.adapter.0.layer.0.SelfAttention.v.weight', 'kadapter.adapter.0.layer.0.SelfAttention.o.weight', 'kadapter.adapter.0.layer.0.SelfAttention.relative_attention_bias.weight', 'kadapter.adapter.1.layer.1.DenseReluDense.wo.weight', 'kadapter.adapter.1.layer.0.layer_norm.weight', 'kadapter.adapter.0.layer.1.DenseReluDense.wi_1.weight', 'kadapter.adapter.1.layer.0.SelfAttention.v.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/1
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 1 processes
----------------------------------------------------------------------------------------------------

LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Set SLURM handle signals.

  | Name  | Type                       | Params
-----------------------------------------------------
0 | model | T5ForConditionalGeneration | 81.7 M
-----------------------------------------------------
4.7 M     Trainable params
77.0 M    Non-trainable params
81.7 M    Total params
326.730   Total estimated model params size (MB)
Namespace(accelerator='ddp', adam_epsilon=1e-08, check_validation_only=False, checkpoint_path='', dataset='templama', dataset_version='2010', early_stop_callback=False, eval_batch_size=32, freeze_embeds=False, freeze_encoder=False, freeze_level=2, learning_rate=0.1, max_grad_norm=0.5, max_input_length=50, max_output_length=25, method='kadapter', mode='pretrain', model_name_or_path='google/t5-small-ssm', n_gpu=1, n_test=-1, n_train=-1, n_val=-1, num_train_epochs=30, num_workers=4, opt_level='O1', output_dir='outputs/T5_small_templama(2010)_lr.001_adapters_prefixed', output_log=None, prefix=True, resume_from_checkpoint=None, seed=42, split=0, split_num=1, tokenizer_name_or_path='google/t5-small-ssm', train_batch_size=32, use_deepspeed=False, use_lr_scheduling=True, val_check_interval=1.0, wandb_log=False, warmup_steps=0, weight_decay=0.0)
config.num_layers = 8
config.num_layers = 8
split is 0
Length of dataset retrieving is.. 2866
Validation sanity check: 0it [00:00, ?it/s]split is 0
Length of dataset retrieving is.. 410
Validation sanity check:   0%|          | 0/2 [00:00<?, ?it/s]output_hidden_states = False
output_hidden_states = True
i = 0, hidden_states size = torch.Size([32, 50, 512])
i = 0, hidden_states size = torch.Size([32, 50, 512])
i = 1, hidden_states size = torch.Size([32, 50, 512])
i = 1, hidden_states size = torch.Size([32, 50, 512])
i = 2, hidden_states size = torch.Size([32, 50, 512])
i = 2, hidden_states size = torch.Size([32, 50, 512])
i = 3, hidden_states size = torch.Size([32, 50, 512])
i = 3, hidden_states size = torch.Size([32, 50, 512])
i = 4, hidden_states size = torch.Size([32, 50, 512])
i = 4, hidden_states size = torch.Size([32, 50, 512])
i = 5, hidden_states size = torch.Size([32, 50, 512])
i = 5, hidden_states size = torch.Size([32, 50, 512])
i = 6, hidden_states size = torch.Size([32, 50, 512])
i = 6, hidden_states size = torch.Size([32, 50, 512])
i = 7, hidden_states size = torch.Size([32, 50, 512])
i = 7, hidden_states size = torch.Size([32, 50, 512])
hidden_states size = torch.Size([32, 50, 512])
res last_hidden_state size = torch.Size([32, 50, 512])
model_kwargs: torch.Size([32, 50, 512])
model_inputs encoder_outputs: BaseModelOutputWithPastAndCrossAttentions(last_hidden_state=tensor([[[ 9.7558e-02, -2.5035e-01,  2.0037e-01,  ..., -4.6349e-02,
           3.1209e-02,  1.3815e-01],
         [ 1.1342e-02,  7.6886e-03,  1.0924e-01,  ..., -1.4596e-01,
           8.0698e-03,  4.0887e-02],
         [ 6.5895e-02, -2.8374e-01,  1.0504e-01,  ..., -3.7779e-02,
           2.0632e-01, -2.6836e-01],
         ...,
         [ 9.1724e-02, -6.4078e-02,  3.1343e-01,  ..., -1.8335e-03,
          -1.4536e-01,  1.5180e-02],
         [ 1.0187e-01, -5.6857e-02,  3.1535e-01,  ...,  5.4652e-04,
          -1.4281e-01,  2.5087e-02],
         [ 8.8810e-02, -1.1717e-01,  3.3323e-01,  ..., -2.0132e-02,
          -9.9177e-02,  3.6396e-02]],

        [[ 9.7558e-02, -2.5035e-01,  2.0037e-01,  ..., -4.6349e-02,
           3.1209e-02,  1.3815e-01],
         [ 1.1342e-02,  7.6886e-03,  1.0924e-01,  ..., -1.4596e-01,
           8.0698e-03,  4.0887e-02],
         [ 6.5895e-02, -2.8374e-01,  1.0504e-01,  ..., -3.7779e-02,
           2.0632e-01, -2.6836e-01],
         ...,
         [ 9.1724e-02, -6.4078e-02,  3.1343e-01,  ..., -1.8335e-03,
          -1.4536e-01,  1.5180e-02],
         [ 1.0187e-01, -5.6857e-02,  3.1535e-01,  ...,  5.4652e-04,
          -1.4281e-01,  2.5087e-02],
         [ 8.8810e-02, -1.1717e-01,  3.3323e-01,  ..., -2.0132e-02,
          -9.9177e-02,  3.6396e-02]],

        [[ 3.4918e-02, -1.8451e-01,  1.0227e-01,  ...,  6.6409e-02,
          -5.7116e-02,  1.5346e-03],
         [-9.8693e-03,  2.6510e-02,  1.4532e-01,  ..., -1.0365e-03,
          -2.9635e-02, -2.4314e-02],
         [ 8.1717e-03, -1.7127e-01,  2.6586e-01,  ...,  3.8682e-02,
           8.6241e-02, -2.3119e-01],
         ...,
         [-4.6509e-02, -8.7623e-02, -7.7191e-02,  ...,  1.4618e-01,
           3.2222e-02,  6.3243e-02],
         [ 1.7365e-02, -9.2976e-02, -8.7583e-02,  ...,  2.0634e-01,
           3.0816e-02,  7.2429e-02],
         [-4.4206e-02, -8.3237e-02, -8.7031e-02,  ...,  2.0128e-01,
          -5.4339e-03,  5.1337e-02]],

        ...,

        [[ 4.1461e-02, -2.3062e-01,  1.4030e-01,  ...,  3.9117e-02,
           8.0473e-02, -4.0550e-02],
         [ 2.8080e-02,  6.2212e-02,  1.0014e-01,  ..., -4.9993e-02,
           3.5224e-02,  1.3274e-03],
         [-4.7108e-03, -1.9315e-01,  7.3718e-02,  ..., -1.3822e-01,
          -1.0156e-01, -2.4319e-01],
         ...,
         [ 1.5650e-01, -4.6298e-02,  1.2935e-01,  ..., -1.7920e-01,
          -4.8330e-02, -1.7780e-01],
         [ 1.4684e-01, -3.6660e-02,  1.3812e-01,  ..., -1.6102e-01,
          -3.5572e-02, -1.7293e-01],
         [ 1.5821e-01, -1.5442e-02,  1.2402e-01,  ..., -1.5847e-01,
          -3.9889e-02, -1.5849e-01]],

        [[-5.4919e-02, -2.0765e-01,  1.1168e-01,  ..., -7.5966e-03,
           2.6684e-02, -1.3542e-01],
         [ 1.2203e-01, -1.7974e-02,  2.2193e-02,  ..., -1.1589e-02,
          -7.1121e-03, -2.0653e-01],
         [-8.3475e-02, -7.4703e-02,  7.5080e-02,  ...,  2.7939e-02,
           5.9308e-02, -5.6672e-02],
         ...,
         [-5.7866e-05, -5.5752e-03,  6.4749e-03,  ..., -5.7553e-03,
           4.6426e-03,  8.0341e-02],
         [-2.6292e-03, -1.3815e-02,  1.9409e-02,  ..., -1.6243e-02,
           1.6529e-02,  6.5747e-02],
         [-8.0499e-04, -9.6827e-03,  1.3452e-02,  ..., -1.1305e-02,
           1.1351e-02,  7.2100e-02]],

        [[-5.4919e-02, -2.0765e-01,  1.1168e-01,  ..., -7.5966e-03,
           2.6684e-02, -1.3542e-01],
         [ 1.2203e-01, -1.7974e-02,  2.2193e-02,  ..., -1.1589e-02,
          -7.1121e-03, -2.0653e-01],
         [-8.3475e-02, -7.4703e-02,  7.5080e-02,  ...,  2.7939e-02,
           5.9308e-02, -5.6672e-02],
         ...,
         [-5.7866e-05, -5.5752e-03,  6.4749e-03,  ..., -5.7553e-03,
           4.6426e-03,  8.0341e-02],
         [-2.6292e-03, -1.3815e-02,  1.9409e-02,  ..., -1.6243e-02,
           1.6529e-02,  6.5747e-02],
         [-8.0499e-04, -9.6827e-03,  1.3452e-02,  ..., -1.1305e-02,
           1.1351e-02,  7.2100e-02]]], device='cuda:0'), past_key_values=None, hidden_states=(tensor([[[ -4.5938,   1.3516,  -1.0547,  ...,   4.1562,   2.8750,  24.5000],
         [  2.5469,  10.4375,   0.3848,  ...,  11.0625,   6.4375,  21.3750],
         [  5.6250, -26.6250,  23.1250,  ...,   5.0625,  38.2500,  13.0000],
         ...,
         [ -0.2412,   0.5312,  -0.4727,  ...,   0.3574,   0.1104,  -2.3750],
         [ -0.2412,   0.5312,  -0.4727,  ...,   0.3574,   0.1104,  -2.3750],
         [ -0.2412,   0.5312,  -0.4727,  ...,   0.3574,   0.1104,  -2.3750]],

        [[ -4.5938,   1.3516,  -1.0547,  ...,   4.1562,   2.8750,  24.5000],
         [  2.5469,  10.4375,   0.3848,  ...,  11.0625,   6.4375,  21.3750],
         [ -1.9688,   5.6562,  18.1250,  ...,   8.1875,  14.8750,   5.5312],
         ...,
         [ -0.2412,   0.5312,  -0.4727,  ...,   0.3574,   0.1104,  -2.3750],
         [ -0.2412,   0.5312,  -0.4727,  ...,   0.3574,   0.1104,  -2.3750],
         [ -0.2412,   0.5312,  -0.4727,  ...,   0.3574,   0.1104,  -2.3750]],

        [[ -4.5938,   1.3516,  -1.0547,  ...,   4.1562,   2.8750,  24.5000],
         [  2.5469,  10.4375,   0.3848,  ...,  11.0625,   6.4375,  21.3750],
         [ 16.6250,  -5.9375,   5.3750,  ...,  -6.8438,  11.6250,  13.5000],
         ...,
         [ -0.2412,   0.5312,  -0.4727,  ...,   0.3574,   0.1104,  -2.3750],
         [ -0.2412,   0.5312,  -0.4727,  ...,   0.3574,   0.1104,  -2.3750],
         [ -0.2412,   0.5312,  -0.4727,  ...,   0.3574,   0.1104,  -2.3750]],

        ...,

        [[ -4.5938,   1.3516,  -1.0547,  ...,   4.1562,   2.8750,  24.5000],
         [  2.5469,  10.4375,   0.3848,  ...,  11.0625,   6.4375,  21.3750],
         [ 16.1250,   6.4375,   3.6875,  ...,   1.3125,  -0.5508,  65.5000],
         ...,
         [ -0.2412,   0.5312,  -0.4727,  ...,   0.3574,   0.1104,  -2.3750],
         [ -0.2412,   0.5312,  -0.4727,  ...,   0.3574,   0.1104,  -2.3750],
         [ -0.2412,   0.5312,  -0.4727,  ...,   0.3574,   0.1104,  -2.3750]],

        [[ -4.5938,   1.3516,  -1.0547,  ...,   4.1562,   2.8750,  24.5000],
         [  2.5469,  10.4375,   0.3848,  ...,  11.0625,   6.4375,  21.3750],
         [ -4.1562, -21.2500, -12.2500,  ...,  23.8750,  -7.8438,   9.8125],
         ...,
         [ -0.2412,   0.5312,  -0.4727,  ...,   0.3574,   0.1104,  -2.3750],
         [ -0.2412,   0.5312,  -0.4727,  ...,   0.3574,   0.1104,  -2.3750],
         [ -0.2412,   0.5312,  -0.4727,  ...,   0.3574,   0.1104,  -2.3750]],

        [[ -4.5938,   1.3516,  -1.0547,  ...,   4.1562,   2.8750,  24.5000],
         [  2.5469,  10.4375,   0.3848,  ...,  11.0625,   6.4375,  21.3750],
         [ 16.1250,   6.4375,   3.6875,  ...,   1.3125,  -0.5508,  65.5000],
         ...,
         [ -0.2412,   0.5312,  -0.4727,  ...,   0.3574,   0.1104,  -2.3750],
         [ -0.2412,   0.5312,  -0.4727,  ...,   0.3574,   0.1104,  -2.3750],
         [ -0.2412,   0.5312,  -0.4727,  ...,   0.3574,   0.1104,  -2.3750]]],
       device='cuda:0'), tensor([[[-5.8563e+00, -1.5739e+00, -8.4892e+00,  ...,  5.6243e+00,
           7.2737e+00,  2.0749e+01],
         [-5.0130e+00,  1.4055e+01,  1.2511e+00,  ...,  3.0245e+01,
           1.8170e+00,  1.9071e+01],
         [ 3.9574e+00, -4.1800e+01,  1.8138e+01,  ...,  2.3513e+00,
           4.0482e+01,  6.5940e+00],
         ...,
         [ 2.0063e+00, -2.4230e+00, -9.3681e-01,  ...,  1.1556e-01,
          -1.7764e+00,  1.1024e+00],
         [ 1.7634e+00, -2.2701e+00, -1.1369e+00,  ...,  3.5699e-01,
          -1.6158e+00,  9.8707e-01],
         [ 1.1559e+00, -2.4353e+00, -7.7372e-01,  ..., -6.3948e-01,
          -1.5914e+00,  7.6233e-01]],

        [[-5.1770e+00, -2.3274e+00, -8.7203e+00,  ...,  5.9468e+00,
           7.7558e+00,  2.1374e+01],
         [-2.0560e+00,  1.5205e+01,  1.3074e+00,  ...,  3.3037e+01,
           1.4316e+00,  2.0238e+01],
         [ 4.4572e+00,  3.0379e+00,  2.1310e+01,  ...,  9.9236e+00,
           1.5433e+01,  6.4700e+00],
         ...,
         [ 1.4497e+00, -4.2599e+00,  4.7088e+00,  ..., -4.4259e+00,
           3.3797e-01,  4.9970e+00],
         [ 1.1860e+00, -3.8714e+00,  4.7248e+00,  ..., -4.0824e+00,
           4.7476e-01,  5.2202e+00],
         [ 7.7929e-01, -3.5836e+00,  4.0641e+00,  ..., -4.4420e+00,
           7.0736e-01,  4.9583e+00]],

        [[-5.6066e+00, -2.4565e+00, -8.7522e+00,  ...,  3.9382e+00,
           7.0806e+00,  2.0439e+01],
         [-3.9898e+00,  1.2328e+01,  1.7870e+00,  ...,  3.1704e+01,
          -3.3748e-01,  2.0174e+01],
         [ 1.2757e+01, -1.6065e+01,  1.4877e+01,  ..., -1.5046e+01,
           5.9288e-01,  1.6214e+01],
         ...,
         [ 1.8259e+00, -4.1473e+00,  7.4392e+00,  ..., -1.9424e+00,
          -2.4253e+00,  7.1878e+00],
         [ 2.0200e+00, -4.0074e+00,  7.1108e+00,  ..., -2.3374e+00,
          -2.1182e+00,  7.0253e+00],
         [ 1.5627e+00, -3.8924e+00,  6.7651e+00,  ..., -2.7856e+00,
          -1.7734e+00,  6.6532e+00]],

        ...,

        [[-6.0459e+00, -2.4059e+00, -8.8349e+00,  ...,  5.9673e+00,
           7.7284e+00,  2.0379e+01],
         [-3.6684e+00,  1.6711e+01, -1.9849e+00,  ...,  3.5785e+01,
           1.4393e+00,  1.6766e+01],
         [ 9.1048e+00,  9.2191e+00,  4.0653e-01,  ..., -3.1319e-02,
          -6.8265e+00,  6.0075e+01],
         ...,
         [-3.8581e+00, -8.1366e+00,  1.0046e+01,  ..., -1.0635e+01,
          -5.9815e+00,  7.0659e+00],
         [-4.0078e+00, -8.2417e+00,  1.0199e+01,  ..., -1.0736e+01,
          -6.0059e+00,  7.2641e+00],
         [-4.1243e+00, -8.0848e+00,  1.0051e+01,  ..., -1.0559e+01,
          -6.2673e+00,  7.3393e+00]],

        [[-5.5741e+00, -2.1893e+00, -9.0443e+00,  ...,  5.0744e+00,
           7.3409e+00,  1.9911e+01],
         [-2.9555e+00,  1.2685e+01,  1.4205e+00,  ...,  3.1387e+01,
           1.8651e+00,  2.0487e+01],
         [-4.6450e-01, -1.9687e+01, -3.6190e+00,  ...,  3.1498e+01,
          -8.6910e+00,  2.4673e+00],
         ...,
         [ 1.9859e+00,  3.6492e-01,  4.2301e+00,  ..., -8.5406e-01,
          -3.3179e+00,  1.5380e+00],
         [ 2.0038e+00,  3.6998e-01,  4.0907e+00,  ..., -7.7935e-01,
          -3.0209e+00,  1.3223e+00],
         [ 2.2087e+00,  4.6493e-01,  4.6858e+00,  ..., -1.6290e+00,
          -2.4002e+00,  1.3993e+00]],

        [[-5.7218e+00, -2.4930e+00, -8.2563e+00,  ...,  6.9441e+00,
           7.7185e+00,  2.0780e+01],
         [-3.7275e+00,  1.5826e+01, -6.0418e-01,  ...,  3.6495e+01,
           1.3364e+00,  1.7170e+01],
         [ 9.6540e+00,  9.0822e+00,  1.1205e+00,  ...,  9.1024e-01,
          -6.9122e+00,  6.0866e+01],
         ...,
         [ 4.3762e+00, -2.1873e+00,  3.1280e+00,  ...,  3.4501e+00,
           1.0562e-01,  9.4223e-01],
         [ 4.3315e+00, -1.7589e+00,  2.9914e+00,  ...,  3.8554e+00,
           2.5335e-01,  1.4830e+00],
         [ 4.4336e+00, -1.6604e+00,  2.8204e+00,  ...,  4.2008e+00,
           1.5791e-01,  1.4227e+00]]], device='cuda:0'), tensor([[[-8.6853e+00, -9.7266e+00, -4.3441e+00,  ...,  1.0840e+01,
           9.5588e+00,  1.2884e+01],
         [ 1.2910e+00,  1.8720e+01,  1.3021e+01,  ...,  2.1768e+01,
           6.0426e+00,  2.3711e+01],
         [ 6.9305e+00, -5.0100e+01,  2.3795e+01,  ...,  1.1669e+01,
           4.8625e+01,  4.2364e+00],
         ...,
         [ 6.4749e+00,  2.4409e+00,  1.2763e+01,  ...,  4.7141e+00,
          -1.2824e+01,  8.6929e+00],
         [ 6.2378e+00,  2.5255e+00,  1.2496e+01,  ...,  5.2536e+00,
          -1.2696e+01,  8.6618e+00],
         [ 5.2635e+00,  2.6109e+00,  1.3252e+01,  ...,  4.7114e+00,
          -1.1060e+01,  7.4282e+00]],

        [[-9.2713e+00, -1.2268e+01,  2.1336e-02,  ...,  8.5658e+00,
           8.9731e+00,  1.0964e+01],
         [ 5.1729e+00,  1.6731e+01,  1.4703e+01,  ...,  2.4528e+01,
           2.4842e+00,  2.1269e+01],
         [ 7.4545e+00,  1.8573e+00,  2.8453e+01,  ...,  2.5209e+01,
           1.3677e+01,  6.2553e+00],
         ...,
         [ 4.9334e+00, -2.2991e+00,  1.8783e+00,  ...,  6.3532e+00,
           1.7119e+00,  5.4274e+00],
         [ 4.5978e+00, -2.3649e+00,  1.3653e+00,  ...,  6.7632e+00,
           2.4749e+00,  5.6099e+00],
         [ 3.4501e+00, -2.0631e+00,  1.0793e+00,  ...,  4.4264e+00,
           1.4812e+00,  4.7759e+00]],

        [[-7.2184e+00, -1.0670e+01, -2.1542e+00,  ...,  4.4082e+00,
           1.0886e+01,  1.1783e+01],
         [ 2.8991e+00,  1.3524e+01,  1.5325e+01,  ...,  1.7593e+01,
           2.8903e+00,  2.3203e+01],
         [ 9.2619e+00, -2.0333e+01,  3.1671e+01,  ..., -1.7382e+01,
           8.6147e-01,  2.2877e+01],
         ...,
         [ 2.8308e+00, -5.5458e+00,  1.0418e+01,  ..., -4.0021e+00,
          -2.6155e-01,  4.8561e+00],
         [ 3.0136e+00, -5.6369e+00,  9.7266e+00,  ..., -4.0818e+00,
           9.5391e-02,  4.3898e+00],
         [ 2.6944e+00, -5.8733e+00,  9.6383e+00,  ..., -4.4099e+00,
          -2.5987e-01,  4.0272e+00]],

        ...,

        [[-9.0915e+00, -1.2220e+01,  1.6511e+00,  ...,  8.2394e+00,
           1.2204e+01,  1.1701e+01],
         [ 1.7133e+00,  1.7728e+01,  9.2005e+00,  ...,  2.5049e+01,
           3.7588e+00,  1.7358e+01],
         [ 1.1504e+01,  1.0145e+01,  5.4224e+00,  ...,  1.0749e+01,
          -4.5218e+00,  5.8565e+01],
         ...,
         [-4.6318e+00, -7.1398e+00,  5.8174e+00,  ...,  1.5975e+00,
          -4.5974e+00,  7.4952e+00],
         [-4.7563e+00, -7.3165e+00,  5.8994e+00,  ...,  1.4715e+00,
          -4.5516e+00,  7.7142e+00],
         [-4.8975e+00, -7.1237e+00,  5.4217e+00,  ...,  1.9776e+00,
          -4.5301e+00,  8.0322e+00]],

        [[-8.0698e+00, -1.0229e+01,  6.7536e-02,  ...,  1.0264e+01,
           1.0119e+01,  9.8852e+00],
         [ 3.3195e+00,  1.6546e+01,  1.6617e+01,  ...,  2.1235e+01,
           3.0549e+00,  2.3142e+01],
         [ 1.2245e+01, -2.6236e+01,  1.2549e+01,  ...,  2.1135e+01,
          -1.8452e+01,  6.7278e+00],
         ...,
         [ 8.0674e+00,  7.5266e+00,  1.6487e+01,  ...,  3.4455e+00,
          -1.6283e+01, -3.1166e-01],
         [ 7.4307e+00,  5.7678e+00,  1.5637e+01,  ...,  3.4661e+00,
          -1.5066e+01, -7.9477e-01],
         [ 7.3201e+00,  2.9935e+00,  1.5404e+01,  ...,  3.1932e+00,
          -1.1242e+01, -1.4888e+00]],

        [[-8.4180e+00, -1.2106e+01,  3.3182e+00,  ...,  1.1018e+01,
           1.0378e+01,  1.1927e+01],
         [ 9.0864e-01,  1.7063e+01,  1.0999e+01,  ...,  2.6605e+01,
           1.8678e+00,  1.7334e+01],
         [ 1.2085e+01,  9.2670e+00,  6.6817e+00,  ...,  9.0698e+00,
          -6.7601e+00,  6.0154e+01],
         ...,
         [ 4.1807e+00, -8.2367e+00,  8.5551e+00,  ...,  1.0371e+01,
          -7.4633e+00, -9.1720e-01],
         [ 3.9828e+00, -8.0435e+00,  8.2076e+00,  ...,  1.0784e+01,
          -7.3362e+00, -5.3498e-01],
         [ 3.8996e+00, -7.8494e+00,  7.9731e+00,  ...,  1.1529e+01,
          -7.5394e+00, -4.5722e-01]]], device='cuda:0'), tensor([[[-8.4713e+00, -2.3762e+01,  9.7288e+00,  ...,  9.7535e-01,
          -6.3813e+00,  1.5641e+01],
         [ 5.6239e+00,  1.8508e+01,  1.7656e+01,  ...,  1.2043e+01,
           2.3432e+00,  2.7469e+01],
         [ 1.1031e+01, -5.7380e+01,  2.9706e+01,  ..., -4.8867e-02,
           6.5443e+01,  7.4261e+00],
         ...,
         [ 1.7427e+01, -8.3526e+00,  2.8861e+01,  ...,  3.4109e+00,
          -7.2001e+00, -8.2296e-01],
         [ 1.7467e+01, -8.0991e+00,  2.8363e+01,  ...,  4.1727e+00,
          -6.8956e+00, -4.0379e-01],
         [ 1.5635e+01, -7.7999e+00,  2.8869e+01,  ...,  3.5352e+00,
          -3.6140e+00, -3.5626e-01]],

        [[-5.2279e+00, -2.9123e+01,  6.1970e+00,  ...,  2.9971e+00,
           2.6161e-01,  9.6742e+00],
         [ 9.8191e+00,  9.8349e+00,  1.8164e+01,  ...,  1.3990e+01,
          -2.6494e+00,  2.4166e+01],
         [ 1.0909e+01, -6.7438e+00,  4.7384e+01,  ...,  3.7369e+01,
           4.2439e+00,  1.5320e+01],
         ...,
         [ 1.0477e+01, -1.3362e+01,  2.0445e+01,  ...,  8.6674e+00,
           1.5827e+00,  4.8095e+00],
         [ 1.1351e+01, -1.4042e+01,  1.8695e+01,  ...,  1.0282e+01,
           2.2799e+00,  4.7863e+00],
         [ 9.3080e+00, -1.2714e+01,  1.9026e+01,  ...,  8.1919e+00,
           5.6474e-01,  6.0995e+00]],

        [[-2.8437e+00, -2.6988e+01,  4.1262e+00,  ..., -4.5023e+00,
          -3.4498e-01,  6.8093e+00],
         [ 7.5572e+00,  1.0948e+01,  1.6315e+01,  ...,  9.7364e+00,
          -2.6643e+00,  2.5487e+01],
         [ 4.9970e+00, -2.6915e+01,  3.7957e+01,  ..., -1.5452e+01,
           4.4235e+00,  2.7132e+01],
         ...,
         [ 8.0887e+00, -1.1977e+01,  1.8543e+01,  ...,  2.2289e+00,
           2.1241e+00,  3.3128e+00],
         [ 8.6849e+00, -1.2323e+01,  1.7538e+01,  ...,  2.0584e+00,
           2.8064e+00,  3.2139e+00],
         [ 7.4933e+00, -1.2536e+01,  1.8034e+01,  ...,  1.3261e+00,
           2.9564e+00,  2.7485e+00]],

        ...,

        [[-4.0584e+00, -2.9402e+01,  8.7674e+00,  ...,  2.7112e+00,
           8.4547e+00,  1.1207e+01],
         [ 9.4722e+00,  7.4499e+00,  1.4062e+01,  ...,  1.5352e+01,
           3.1005e+00,  1.9055e+01],
         [ 2.0033e+01,  1.2919e+00,  1.3165e+01,  ...,  1.0601e+01,
          -3.8108e+00,  6.0344e+01],
         ...,
         [ 8.5247e-01, -7.9464e+00,  6.2233e+00,  ..., -3.7597e+00,
          -3.1051e+00,  8.4062e+00],
         [ 8.8737e-01, -7.8427e+00,  5.7823e+00,  ..., -4.1167e+00,
          -3.5973e+00,  8.9807e+00],
         [ 5.7630e-01, -7.9944e+00,  5.1299e+00,  ..., -4.2414e+00,
          -3.7758e+00,  9.3712e+00]],

        [[-6.3975e+00, -2.6303e+01,  9.8983e+00,  ...,  9.6027e+00,
          -2.7641e-01,  7.2169e+00],
         [ 9.0399e+00,  1.2581e+01,  2.0920e+01,  ...,  1.5681e+01,
           1.7194e-01,  2.5465e+01],
         [ 5.2261e+00, -4.7897e+01,  2.9634e+01,  ...,  1.5301e+01,
          -3.1221e+01,  3.6244e-01],
         ...,
         [ 1.7205e+01, -5.3152e+00,  1.1396e+01,  ..., -6.1150e-01,
          -9.5771e+00, -1.6497e+01],
         [ 1.6815e+01, -6.0366e+00,  1.1124e+01,  ..., -2.2103e-01,
          -8.1001e+00, -1.6331e+01],
         [ 1.6910e+01, -6.1246e+00,  9.8103e+00,  ..., -1.0470e+00,
          -2.9535e+00, -1.4262e+01]],

        [[-4.4649e+00, -2.7752e+01,  9.4768e+00,  ...,  4.9694e+00,
           7.2258e+00,  1.1357e+01],
         [ 6.3594e+00,  6.5736e+00,  1.4577e+01,  ...,  1.4011e+01,
           8.7710e-01,  2.0336e+01],
         [ 1.6612e+01,  1.4235e+00,  1.1060e+01,  ...,  7.3106e+00,
          -6.4555e+00,  6.2502e+01],
         ...,
         [ 6.9636e+00, -8.5412e+00,  1.4879e+01,  ...,  1.2502e+01,
          -4.2592e+00,  1.7864e+00],
         [ 6.6885e+00, -7.5061e+00,  1.4806e+01,  ...,  1.3085e+01,
          -4.8787e+00,  2.5816e+00],
         [ 6.7987e+00, -7.4859e+00,  1.4289e+01,  ...,  1.3644e+01,
          -4.8519e+00,  2.5876e+00]]], device='cuda:0'), tensor([[[-5.2759e+00, -3.7760e+01,  9.1099e+00,  ..., -3.1577e+00,
          -1.4588e+01,  2.8756e+01],
         [ 9.6564e+00,  1.5246e+01,  2.8620e+01,  ...,  1.7243e+01,
          -1.6827e+01,  3.4344e+01],
         [ 5.5476e+00, -7.6096e+01,  3.8652e+01,  ..., -7.4716e-01,
           7.6892e+01,  1.2245e+01],
         ...,
         [ 8.4681e+00,  1.0966e-01,  4.5226e+01,  ..., -1.5590e+01,
          -2.6382e+01, -2.8977e-01],
         [ 8.3379e+00, -7.4906e-01,  4.4599e+01,  ..., -1.3982e+01,
          -2.6146e+01,  8.0598e-01],
         [ 5.8659e+00,  2.5979e-01,  4.5133e+01,  ..., -1.5608e+01,
          -2.0942e+01,  1.2351e-01]],

        [[-2.8223e+00, -4.1686e+01,  7.1111e+00,  ..., -2.0434e+00,
          -7.2557e+00,  9.7747e+00],
         [ 1.2059e+01,  1.7730e+01,  2.6677e+01,  ...,  2.3100e+01,
          -2.1978e+01,  2.2979e+01],
         [ 8.3870e+00, -1.1111e+01,  6.6878e+01,  ...,  3.5404e+01,
           1.3656e+00,  1.9252e+01],
         ...,
         [ 3.7686e-01, -1.7108e+01,  3.7081e+01,  ..., -4.4351e+00,
          -1.9895e+01,  6.3754e+00],
         [ 4.4528e+00, -1.4978e+01,  3.3571e+01,  ..., -1.3249e-01,
          -1.5858e+01,  8.1119e+00],
         [ 2.5326e-02, -1.4389e+01,  3.8060e+01,  ..., -4.7240e+00,
          -2.0132e+01,  8.3547e+00]],

        [[-1.3268e-01, -4.2088e+01,  2.9815e+00,  ..., -1.0382e+01,
          -9.6439e+00,  9.8822e+00],
         [ 8.5871e+00,  1.3531e+01,  2.6250e+01,  ...,  2.3837e+01,
          -2.1544e+01,  2.5773e+01],
         [-2.4833e+00, -5.2216e+01,  6.4780e+01,  ..., -2.5884e+01,
           2.2592e+00,  2.7856e+01],
         ...,
         [ 3.5784e+00, -9.6705e+00,  3.3005e+01,  ..., -1.0496e+00,
          -9.2092e+00,  4.4778e+00],
         [ 5.5100e+00, -1.0281e+01,  3.2182e+01,  ..., -2.0413e+00,
          -8.8915e+00,  4.7531e+00],
         [ 4.9510e+00, -1.1725e+01,  3.2399e+01,  ..., -4.1030e+00,
          -1.0088e+01,  4.4939e+00]],

        ...,

        [[ 2.5635e+00, -4.0413e+01,  1.3521e+01,  ..., -2.2455e+00,
          -2.9423e+00,  1.6322e+01],
         [ 1.3808e+01,  1.2604e+01,  2.1632e+01,  ...,  2.0252e+01,
          -8.7572e+00,  1.8783e+01],
         [ 1.4312e+01, -1.1580e+01,  2.0605e+01,  ..., -1.5631e+00,
          -1.1734e+01,  6.0223e+01],
         ...,
         [ 1.3697e+01, -1.0505e+01,  1.4698e+01,  ..., -1.6170e+01,
          -1.0965e+01,  1.2527e+01],
         [ 1.4186e+01, -1.0873e+01,  1.4593e+01,  ..., -1.6956e+01,
          -1.1498e+01,  1.3121e+01],
         [ 1.3698e+01, -1.0004e+01,  1.4214e+01,  ..., -1.7199e+01,
          -1.1587e+01,  1.3560e+01]],

        [[-3.2229e+00, -4.2829e+01,  1.2689e+01,  ..., -3.3191e+00,
          -6.3046e+00,  8.5042e+00],
         [ 9.9631e+00,  1.2847e+01,  3.3318e+01,  ...,  2.5500e+01,
          -1.6933e+01,  2.2305e+01],
         [ 8.5019e+00, -6.7373e+01,  5.5394e+01,  ...,  4.1095e+00,
          -3.3239e+01, -4.4337e+00],
         ...,
         [ 9.9201e+00, -5.9469e+00,  3.3028e+01,  ..., -7.0369e+00,
          -3.9281e+01, -1.3151e+01],
         [ 8.9486e+00, -7.7248e+00,  3.1845e+01,  ..., -7.0462e+00,
          -3.7695e+01, -1.2506e+01],
         [ 8.7192e+00, -8.6778e+00,  2.9831e+01,  ..., -7.0565e+00,
          -3.2706e+01, -9.5789e+00]],

        [[-3.3300e+00, -3.8386e+01,  8.4022e+00,  ..., -4.6440e+00,
          -4.7412e-01,  1.5163e+01],
         [ 6.5260e+00,  9.9142e+00,  1.5824e+01,  ...,  1.7581e+01,
          -1.0669e+01,  1.9498e+01],
         [ 1.2993e+01, -1.1043e+01,  1.3851e+01,  ..., -7.3691e+00,
          -9.7562e+00,  6.3511e+01],
         ...,
         [ 2.7559e-01,  2.8627e+00,  1.6479e+01,  ...,  8.2315e+00,
          -1.2584e+01, -2.3796e+00],
         [-6.6772e-02,  4.2578e+00,  1.6300e+01,  ...,  8.3040e+00,
          -1.2446e+01, -2.1728e+00],
         [ 9.8106e-02,  4.4399e+00,  1.6156e+01,  ...,  8.9767e+00,
          -1.2092e+01, -2.4802e+00]]], device='cuda:0'), tensor([[[-4.2051e+00, -3.5053e+01,  1.3520e+01,  ..., -2.0496e+01,
          -4.0645e+01,  3.6190e+01],
         [ 7.6905e+00,  1.9257e+01,  5.3226e+01,  ...,  2.3239e+01,
          -2.0381e+01,  3.2464e+01],
         [-3.7494e-02, -8.9625e+01,  4.6902e+01,  ..., -3.7366e+00,
           6.1099e+01,  2.5599e+00],
         ...,
         [ 2.0221e+01, -3.7312e+00,  4.8403e+01,  ..., -2.8998e+01,
          -2.6356e+01,  1.1921e+01],
         [ 1.9634e+01, -5.1594e+00,  4.7977e+01,  ..., -2.6120e+01,
          -2.7160e+01,  1.3079e+01],
         [ 9.6462e+00, -5.4550e+00,  4.8746e+01,  ..., -2.9753e+01,
          -2.1588e+01,  9.4004e+00]],

        [[ 9.5839e+00, -5.2119e+01,  1.0397e+01,  ..., -4.3589e+00,
          -4.2970e+01,  2.4719e+01],
         [ 2.8569e-01,  1.7085e+01,  4.8775e+01,  ...,  2.9102e+01,
          -2.9303e+01,  2.2328e+01],
         [-6.6519e+00, -2.7931e+01,  7.8220e+01,  ...,  4.1259e+01,
           5.5320e+00,  7.5853e+00],
         ...,
         [-1.6592e+01, -1.1139e+01,  8.3024e+00,  ..., -1.3306e+01,
          -2.1738e+01,  5.3098e+00],
         [-8.7844e+00, -1.8518e+01,  8.9239e+00,  ..., -8.5940e+00,
          -1.9042e+01,  4.9788e+00],
         [-1.4797e+01, -1.8299e+01,  1.4605e+01,  ..., -1.0935e+01,
          -2.3601e+01,  4.9254e+00]],

        [[ 2.9066e+01, -6.5220e+01,  1.2651e+01,  ..., -9.2892e+00,
          -5.3182e+01,  1.8916e+01],
         [ 5.0111e+00,  1.7414e+01,  5.2060e+01,  ...,  2.3830e+01,
          -3.0225e+01,  2.3601e+01],
         [-1.8250e+01, -7.2701e+01,  8.6252e+01,  ..., -3.0322e+01,
           1.1066e+00,  2.2502e+01],
         ...,
         [ 6.9876e+00, -1.4848e+01,  2.4062e+01,  ..., -6.2546e+00,
          -1.2625e+01,  1.0466e+01],
         [ 9.7342e+00, -1.8093e+01,  2.4776e+01,  ..., -8.0048e+00,
          -1.0816e+01,  1.1572e+01],
         [ 6.7645e+00, -2.2359e+01,  2.6781e+01,  ..., -7.7450e+00,
          -1.0086e+01,  9.3354e+00]],

        ...,

        [[ 2.2384e+01, -8.8442e+01,  1.6703e+01,  ..., -8.9756e+00,
          -4.1758e+01,  3.8664e+01],
         [ 1.5527e+01, -1.1674e+00,  4.9705e+01,  ...,  2.5007e+01,
          -6.6438e+00,  1.4081e+01],
         [ 1.1118e+01, -7.8324e+00,  3.8641e+01,  ...,  1.1375e+01,
          -3.6784e+01,  6.3049e+01],
         ...,
         [ 1.4508e+01, -1.1322e+01, -4.1899e+00,  ..., -1.3848e+01,
          -3.3985e+01,  5.2339e-01],
         [ 1.4344e+01, -1.1102e+01, -5.0684e+00,  ..., -1.4530e+01,
          -3.4780e+01,  1.8374e+00],
         [ 1.3906e+01, -9.5357e+00, -5.9056e+00,  ..., -1.5844e+01,
          -3.5219e+01,  2.1222e+00]],

        [[ 1.2735e+01, -4.4387e+01,  2.0153e+01,  ..., -1.0868e+01,
          -2.3342e+01,  1.5097e+01],
         [ 6.9700e+00,  2.3592e+01,  5.2640e+01,  ...,  2.6664e+01,
          -1.3854e+01,  1.9385e+01],
         [ 7.5491e+00, -6.1263e+01,  5.4419e+01,  ..., -3.4780e+00,
          -5.3254e+01, -9.6810e+00],
         ...,
         [ 1.0225e+01, -2.2615e+01,  2.7002e+01,  ..., -2.9303e+01,
          -3.3068e+01, -1.7101e+01],
         [ 7.8031e+00, -2.3485e+01,  2.7020e+01,  ..., -2.8761e+01,
          -3.0411e+01, -1.6839e+01],
         [ 6.8800e+00, -2.6005e+01,  2.9279e+01,  ..., -2.7350e+01,
          -2.6493e+01, -1.2096e+01]],

        [[ 1.6641e+01, -8.6696e+01,  4.2054e+00,  ..., -1.6308e+01,
          -4.3938e+01,  3.1414e+01],
         [ 1.6843e+01,  7.8148e-01,  2.4757e+01,  ...,  1.6238e+01,
          -1.9787e+01,  1.6383e+01],
         [ 1.9404e+01, -1.4289e-01,  1.4818e+01,  ...,  3.1358e+00,
          -3.0210e+01,  6.9431e+01],
         ...,
         [-1.0346e+01, -1.1014e+01,  5.9796e+00,  ..., -8.9767e+00,
          -2.1143e+01, -8.0995e+00],
         [-1.0787e+01, -1.2084e+01,  7.9466e+00,  ..., -8.2799e+00,
          -1.9926e+01, -9.8835e+00],
         [-1.0145e+01, -1.1201e+01,  7.8612e+00,  ..., -7.5403e+00,
          -1.9763e+01, -1.0434e+01]]], device='cuda:0'), tensor([[[ 18.2609, -86.8231,  40.3585,  ..., -23.3856, -41.1231,  50.4102],
         [  1.8192,  10.0604,  49.4722,  ...,  15.5042, -18.5584,  36.2983],
         [ -5.1578, -93.0932,  38.8557,  ..., -10.2799,  62.4577,  -8.6725],
         ...,
         [ 31.5868, -19.5005,  45.1913,  ..., -13.1820, -34.4002,  11.0172],
         [ 32.2381, -20.2128,  43.9573,  ..., -10.9991, -34.7230,  12.4347],
         [ 22.6456, -27.0314,  42.2120,  ..., -17.1100, -21.6005,  10.1778]],

        [[ -0.2503, -64.2571,  18.7083,  ...,   5.8386, -42.5657,  46.4550],
         [ -6.7139,  38.3285,  47.0283,  ...,  35.5785, -13.9908,  22.2301],
         [-14.1855, -11.2807,  74.1645,  ...,  38.5892,   8.9913,   2.4691],
         ...,
         [-18.0898, -25.6279,  12.1745,  ...,  -7.8009,  -9.2224,  29.4670],
         [-12.1006, -28.6289,  13.6785,  ...,  -2.3938, -12.6798,  34.3348],
         [-20.3213, -24.9401,  18.5913,  ...,  -8.9644, -15.6607,  32.8244]],

        [[ 13.5853, -95.8132,  37.2348,  ...,   4.0455, -46.8326,  31.8787],
         [  2.1345,  25.6276,  60.5598,  ...,  33.2489, -24.3915,  17.0395],
         [ -8.9816, -73.8393,  91.6652,  ..., -30.5107,   2.6602,  17.8826],
         ...,
         [ -6.1974, -48.2857,  29.7942,  ..., -10.6916,   8.9129,  20.2509],
         [ -4.2749, -48.3213,  29.8572,  ..., -12.3144,  10.2774,  22.7825],
         [ -2.7400, -57.3152,  29.8453,  ..., -12.7572,   9.7145,  25.1728]],

        ...,

        [[  6.5351, -92.7556,  23.1148,  ..., -22.0562, -25.2119,  48.5361],
         [ 27.7904,   7.4005,  42.5507,  ...,   5.2483,   4.8460,  -4.7299],
         [ 18.8373,  -4.3916,  48.9745,  ...,   6.9524, -30.9773,  45.9046],
         ...,
         [ 21.0970, -33.6320,   6.2444,  ..., -27.4325, -13.0041,  -3.4139],
         [ 21.8355, -33.2962,   5.7349,  ..., -28.0993, -12.2389,  -1.5596],
         [ 23.0515, -32.2708,   5.5162,  ..., -29.8663, -12.2473,  -0.9784]],

        [[ 22.8263, -77.1838,  32.0001,  ...,  -4.3425, -24.4669,  33.2926],
         [ 11.1981,  31.5904,  51.7435,  ...,  13.2055,  -8.9197,  25.4089],
         [ 16.8960, -46.0157,  53.3229,  ..., -26.9182, -66.9187, -13.2344],
         ...,
         [ 20.5377, -29.0082,  44.8667,  ..., -35.4766, -36.4048, -11.2970],
         [ 16.5420, -28.1108,  42.9036,  ..., -33.2315, -34.3957,  -9.7743],
         [ 13.3959, -28.9234,  39.0672,  ..., -31.8077, -30.8993,  -5.1536]],

        [[-13.6248, -97.5521,  18.9547,  ..., -29.8720, -24.1061,  42.1017],
         [ 24.9106,   7.1496,  16.6960,  ...,  -5.7408,  -6.0680, -11.9474],
         [ 25.0611,   8.4484,  26.3531,  ...,  14.8042,  -7.2193,  50.1913],
         ...,
         [ -8.0536, -14.1799,  16.3523,  ..., -27.6023,  -9.5636, -16.7417],
         [ -9.0557, -13.7867,  17.3266,  ..., -27.9893,  -8.8634, -19.7893],
         [ -8.3416, -13.3537,  17.4593,  ..., -27.0696,  -8.4678, -20.5095]]],
       device='cuda:0'), tensor([[[ 9.0076e+00, -1.4665e+02,  6.0169e+01,  ..., -3.3387e+00,
          -1.0481e+01,  9.8708e+01],
         [ 8.1265e+00,  4.4522e-01,  3.5499e+01,  ..., -4.5285e+00,
           2.1469e+00,  3.9556e+01],
         [ 8.5637e+00, -1.5227e+02,  3.5434e+01,  ..., -2.4518e+01,
           8.7890e+01, -3.8335e+01],
         ...,
         [ 3.1338e+01, -1.7568e+01,  5.9497e+01,  ..., -9.7582e+00,
          -4.2618e+01,  2.6295e+01],
         [ 3.2103e+01, -1.8532e+01,  5.8110e+01,  ..., -9.9184e+00,
          -4.2153e+01,  2.9132e+01],
         [ 2.6666e+01, -2.8251e+01,  5.8079e+01,  ..., -1.3815e+01,
          -3.0082e+01,  2.8558e+01]],

        [[-2.1183e+01, -1.3008e+02,  3.3302e+01,  ...,  5.2980e+01,
          -2.0649e+01,  1.9765e+01],
         [-7.5780e+00,  2.1216e+01,  4.2487e+01,  ...,  3.3441e+01,
           4.0107e+00, -1.7654e+00],
         [ 7.4990e-01, -4.8632e+01,  7.2250e+01,  ...,  2.0492e+01,
           2.4307e+01, -3.3413e+01],
         ...,
         [-1.7546e+01, -4.3537e+01,  8.9269e-01,  ...,  1.6512e+01,
          -2.4785e+00,  3.4038e+01],
         [ 2.5001e+00, -4.7032e+01,  1.8133e+00,  ...,  2.2591e+01,
          -9.3935e+00,  3.8361e+01],
         [-1.0568e+01, -4.3471e+01,  1.5121e+00,  ...,  1.4921e+01,
          -1.3717e+01,  3.4469e+01]],

        [[-9.0813e-01, -1.5351e+02,  4.0256e+01,  ...,  6.7196e+01,
          -1.9950e+01,  2.6110e+01],
         [-2.4881e-02,  2.2629e+01,  5.5053e+01,  ...,  3.0213e+01,
          -1.1729e+00,  8.1545e+00],
         [-2.0586e+00, -1.0077e+02,  9.2693e+01,  ..., -5.4560e+01,
           3.6151e-01, -1.1650e+01],
         ...,
         [ 2.5578e+01, -6.7029e+01,  3.2215e+01,  ..., -1.9331e+01,
           9.9587e+00,  3.9397e+01],
         [ 3.8634e+01, -6.2254e+01,  2.7289e+01,  ..., -2.5708e+01,
           1.2734e+01,  5.3768e+01],
         [ 4.3316e+01, -8.1297e+01,  3.1336e+01,  ..., -2.6186e+01,
           1.4289e+01,  7.0032e+01]],

        ...,

        [[-2.1312e+01, -1.7257e+02,  3.6738e+01,  ...,  1.9654e+01,
           8.7544e-01,  5.5236e+01],
         [ 9.3333e+00, -1.8449e+01,  2.7325e+01,  ...,  1.3646e+01,
           3.6623e+01, -3.6923e+01],
         [-3.6535e+01, -8.8811e+01,  5.8755e+01,  ...,  1.9878e+00,
           9.6661e+00,  1.8379e+01],
         ...,
         [ 1.7523e+01, -7.5416e+01,  6.5642e+00,  ..., -2.7235e+01,
           1.5021e+01,  5.2436e+00],
         [ 1.8484e+01, -7.4617e+01,  6.3350e+00,  ..., -2.7840e+01,
           1.6020e+01,  1.7961e+01],
         [ 2.1836e+01, -7.4146e+01,  5.8221e+00,  ..., -2.9360e+01,
           1.5994e+01,  3.2088e+01]],

        [[ 1.9958e+01, -1.2056e+02,  4.0514e+01,  ...,  4.8284e+01,
           1.8507e+01,  4.1088e+01],
         [ 1.0107e+01,  1.5182e+01,  4.7362e+01,  ..., -3.2043e+00,
           2.3977e+01,  1.9364e+01],
         [ 9.7065e+00, -7.3362e+01,  3.0952e+01,  ..., -2.9308e+01,
          -5.5593e+01, -4.8805e+01],
         ...,
         [ 3.4371e+01, -1.4133e+01,  5.2923e+01,  ..., -2.9990e+01,
          -1.2464e+01, -2.7835e+00],
         [ 3.2073e+01, -1.3029e+01,  5.2910e+01,  ..., -2.6946e+01,
          -1.0999e+01,  9.8244e-01],
         [ 2.7191e+01, -9.0611e+00,  4.7993e+01,  ..., -2.7538e+01,
          -1.1164e+01,  5.9095e+00]],

        [[-4.9943e+01, -1.9460e+02,  3.9572e+01,  ...,  1.7201e+01,
           2.8828e+00,  2.9177e+01],
         [-3.9689e-01, -5.6978e+01,  9.9110e+00,  ..., -1.5985e+01,
           2.7804e+01, -5.4880e+01],
         [-4.6484e+01, -6.9781e+01,  3.8835e+01,  ...,  1.0280e+01,
           3.7450e+01,  1.5867e+01],
         ...,
         [-3.0990e+01, -5.5021e+01,  3.8465e+01,  ..., -5.0381e+01,
           2.2384e+01,  1.5005e+01],
         [-3.1793e+01, -5.2326e+01,  3.9032e+01,  ..., -5.1839e+01,
           2.1961e+01, -1.7765e+00],
         [-2.8845e+01, -4.9915e+01,  3.8661e+01,  ..., -4.9831e+01,
           2.2267e+01,  1.3951e+00]]], device='cuda:0'), tensor([[[ 9.7558e-02, -2.5035e-01,  2.0037e-01,  ..., -4.6349e-02,
           3.1209e-02,  1.3815e-01],
         [ 1.1342e-02,  7.6886e-03,  1.0924e-01,  ..., -1.4596e-01,
           8.0698e-03,  4.0887e-02],
         [ 6.5895e-02, -2.8374e-01,  1.0504e-01,  ..., -3.7779e-02,
           2.0632e-01, -2.6836e-01],
         ...,
         [ 9.1724e-02, -6.4078e-02,  3.1343e-01,  ..., -1.8335e-03,
          -1.4536e-01,  1.5180e-02],
         [ 1.0187e-01, -5.6857e-02,  3.1535e-01,  ...,  5.4652e-04,
          -1.4281e-01,  2.5087e-02],
         [ 8.8810e-02, -1.1717e-01,  3.3323e-01,  ..., -2.0132e-02,
          -9.9177e-02,  3.6396e-02]],

        [[ 3.4918e-02, -1.8451e-01,  1.0227e-01,  ...,  6.6409e-02,
          -5.7116e-02,  1.5346e-03],
         [-9.8693e-03,  2.6510e-02,  1.4532e-01,  ..., -1.0365e-03,
          -2.9635e-02, -2.4314e-02],
         [ 8.1717e-03, -1.7127e-01,  2.6586e-01,  ...,  3.8682e-02,
           8.6241e-02, -2.3119e-01],
         ...,
         [-4.6509e-02, -8.7623e-02, -7.7191e-02,  ...,  1.4618e-01,
           3.2222e-02,  6.3243e-02],
         [ 1.7365e-02, -9.2976e-02, -8.7583e-02,  ...,  2.0634e-01,
           3.0816e-02,  7.2429e-02],
         [-4.4206e-02, -8.3237e-02, -8.7031e-02,  ...,  2.0128e-01,
          -5.4339e-03,  5.1337e-02]],

        [[ 3.9265e-02, -2.2550e-01,  1.2816e-01,  ...,  2.2199e-02,
          -5.5012e-03,  1.4265e-03],
         [-1.8853e-02,  7.4587e-02,  1.6183e-01,  ..., -2.5493e-02,
          -1.9122e-02, -1.3726e-02],
         [-6.8891e-02, -2.6592e-01,  2.3816e-01,  ..., -1.4895e-01,
          -3.5755e-02, -1.3579e-01],
         ...,
         [ 1.1876e-02, -3.0293e-02,  2.2710e-02,  ..., -2.3590e-02,
           1.4471e-02,  1.0469e-01],
         [ 4.6328e-03, -8.2767e-03,  6.4020e-03,  ..., -6.0712e-03,
           4.6191e-03,  9.3918e-02],
         [ 3.7374e-03, -6.5442e-03,  4.4653e-03,  ..., -3.1668e-03,
           1.7214e-03,  9.2307e-02]],

        ...,

        [[ 6.7659e-03, -2.0092e-01,  1.0014e-01,  ..., -1.0520e-03,
           2.6914e-02, -1.1803e-01],
         [ 1.3934e-01,  3.0203e-02,  6.7916e-02,  ...,  5.8190e-02,
           3.8342e-02, -1.6774e-01],
         [-7.7783e-02, -9.2330e-02,  1.3047e-01,  ...,  2.9939e-02,
           3.8902e-02, -9.2162e-02],
         ...,
         [ 7.0707e-03, -1.9679e-01, -1.2258e-02,  ..., -1.0343e-01,
           1.2535e-01, -1.3208e-01],
         [ 6.3187e-03, -4.0984e-02, -5.7352e-04,  ..., -1.9474e-02,
           2.3799e-02,  6.3303e-02],
         [ 4.6872e-03, -1.1507e-02, -4.7746e-04,  ..., -5.3425e-03,
           5.1349e-03,  8.2709e-02]],

        [[ 4.1461e-02, -2.3062e-01,  1.4030e-01,  ...,  3.9117e-02,
           8.0473e-02, -4.0550e-02],
         [ 2.8080e-02,  6.2212e-02,  1.0014e-01,  ..., -4.9993e-02,
           3.5224e-02,  1.3274e-03],
         [-4.7108e-03, -1.9315e-01,  7.3718e-02,  ..., -1.3822e-01,
          -1.0156e-01, -2.4319e-01],
         ...,
         [ 1.5650e-01, -4.6298e-02,  1.2935e-01,  ..., -1.7920e-01,
          -4.8330e-02, -1.7780e-01],
         [ 1.4684e-01, -3.6660e-02,  1.3812e-01,  ..., -1.6102e-01,
          -3.5572e-02, -1.7293e-01],
         [ 1.5821e-01, -1.5442e-02,  1.2402e-01,  ..., -1.5847e-01,
          -3.9889e-02, -1.5849e-01]],

        [[-5.4919e-02, -2.0765e-01,  1.1168e-01,  ..., -7.5966e-03,
           2.6684e-02, -1.3542e-01],
         [ 1.2203e-01, -1.7974e-02,  2.2193e-02,  ..., -1.1589e-02,
          -7.1121e-03, -2.0653e-01],
         [-8.3475e-02, -7.4703e-02,  7.5080e-02,  ...,  2.7939e-02,
           5.9308e-02, -5.6672e-02],
         ...,
         [-5.7866e-05, -5.5752e-03,  6.4749e-03,  ..., -5.7553e-03,
           4.6426e-03,  8.0341e-02],
         [-2.6292e-03, -1.3815e-02,  1.9409e-02,  ..., -1.6243e-02,
           1.6529e-02,  6.5747e-02],
         [-8.0499e-04, -9.6827e-03,  1.3452e-02,  ..., -1.1305e-02,
           1.1351e-02,  7.2100e-02]]], device='cuda:0')), attentions=None, cross_attentions=None)
encoder_outputs are None = False
last_hidden_state size = torch.Size([64, 50, 512])
last_hidden_state size = torch.Size([64, 50, 512])
last_hidden_state size = torch.Size([64, 50, 512])
Adapter forward()
sequence_output size = torch.Size([64, 50, 512])
hidden_states length = 9
hidden_states[1] size = torch.Size([32, 50, 512])
Traceback (most recent call last):
  File "run.py", line 165, in <module>
    trainer.fit(model)
  File "/mmfs1/gscratch/ark/tjung2/miniconda3/envs/ckl/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 460, in fit
    self._run(model)
  File "/mmfs1/gscratch/ark/tjung2/miniconda3/envs/ckl/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 758, in _run
    self.dispatch()
  File "/mmfs1/gscratch/ark/tjung2/miniconda3/envs/ckl/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 799, in dispatch
    self.accelerator.start_training(self)
  File "/mmfs1/gscratch/ark/tjung2/miniconda3/envs/ckl/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 96, in start_training
    self.training_type_plugin.start_training(trainer)
  File "/mmfs1/gscratch/ark/tjung2/miniconda3/envs/ckl/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 144, in start_training
    self._results = trainer.run_stage()
  File "/mmfs1/gscratch/ark/tjung2/miniconda3/envs/ckl/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 809, in run_stage
    return self.run_train()
  File "/mmfs1/gscratch/ark/tjung2/miniconda3/envs/ckl/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 844, in run_train
    self.run_sanity_check(self.lightning_module)
  File "/mmfs1/gscratch/ark/tjung2/miniconda3/envs/ckl/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1112, in run_sanity_check
    self.run_evaluation()
  File "/mmfs1/gscratch/ark/tjung2/miniconda3/envs/ckl/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 967, in run_evaluation
    output = self.evaluation_loop.evaluation_step(batch, batch_idx, dataloader_idx)
  File "/mmfs1/gscratch/ark/tjung2/miniconda3/envs/ckl/lib/python3.8/site-packages/pytorch_lightning/trainer/evaluation_loop.py", line 174, in evaluation_step
    output = self.trainer.accelerator.validation_step(args)
  File "/mmfs1/gscratch/ark/tjung2/miniconda3/envs/ckl/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 226, in validation_step
    return self.training_type_plugin.validation_step(*args)
  File "/mmfs1/gscratch/ark/tjung2/miniconda3/envs/ckl/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/ddp.py", line 340, in validation_step
    return self.model(*args, **kwargs)
  File "/mmfs1/gscratch/ark/tjung2/miniconda3/envs/ckl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/mmfs1/gscratch/ark/tjung2/miniconda3/envs/ckl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 799, in forward
    output = self.module(*inputs[0], **kwargs[0])
  File "/mmfs1/gscratch/ark/tjung2/miniconda3/envs/ckl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/mmfs1/gscratch/ark/tjung2/miniconda3/envs/ckl/lib/python3.8/site-packages/pytorch_lightning/overrides/base.py", line 57, in forward
    output = self.module.validation_step(*inputs, **kwargs)
  File "/mmfs1/gscratch/ark/tjung2/continual-knowledge-learning/models/T5_Model.py", line 356, in validation_step
    preds = self._generative_step(batch)
  File "/mmfs1/gscratch/ark/tjung2/continual-knowledge-learning/models/T5_Model.py", line 317, in _generative_step
    generated_ids = self.model.generate(
  File "/mmfs1/gscratch/ark/tjung2/miniconda3/envs/ckl/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 28, in decorate_context
    return func(*args, **kwargs)
  File "/mmfs1/gscratch/ark/tjung2/miniconda3/envs/ckl/lib/python3.8/site-packages/transformers/generation_utils.py", line 1055, in generate
    return self.beam_search(
  File "/mmfs1/gscratch/ark/tjung2/miniconda3/envs/ckl/lib/python3.8/site-packages/transformers/generation_utils.py", line 1792, in beam_search
    outputs = self(
  File "/mmfs1/gscratch/ark/tjung2/miniconda3/envs/ckl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/mmfs1/gscratch/ark/tjung2/continual-knowledge-learning/models/Kadapter_T5.py", line 1596, in forward
    hidden_states = self.kadapter(encoder_outputs)
  File "/mmfs1/gscratch/ark/tjung2/miniconda3/envs/ckl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/mmfs1/gscratch/ark/tjung2/continual-knowledge-learning/models/Kadapter_T5.py", line 1763, in forward
    fusion_state = pretrained_hidden_state + hidden_states_last
RuntimeError: The size of tensor a (32) must match the size of tensor b (64) at non-singleton dimension 0
